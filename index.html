<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exam Performance Analysis: Spanish IE4</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Plotly.js -->
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

    <style>
        /* LMS SAFEGUARD: Ensure html/body take up full height but don't force styles that Canvas might override */
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
        }

        /* Custom Chart Container Styling */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            height: 350px; /* Base height */
            max-height: 400px;
            margin-left: auto;
            margin-right: auto;
        }

        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
            }
        }

        /* Palette Classes for Dynamic Usage */
        .text-primary { color: #2563EB; } /* Vibrant Blue */
        .bg-primary { background-color: #2563EB; }
        .text-accent { color: #F97316; } /* Orange */
        .bg-accent { background-color: #F97316; }
        .text-secondary { color: #14B8A6; } /* Teal */
        .bg-secondary { background-color: #14B8A6; }
        
        .card-shadow {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
    </style>
</head>
<body>

    <!-- WRAPPER DIV: Handles Background/Font for LMS Compatibility -->
    <div id="app-container" class="min-h-screen bg-slate-50 font-[Poppins,sans-serif] text-slate-800 pb-12">

        <!-- Header Section -->
        <header class="bg-gradient-to-r from-blue-600 to-teal-500 text-white p-6 md:p-8 shadow-lg">
            <!-- Constrained width (max-w-5xl) to fit better in Canvas frames -->
            <div class="max-w-5xl mx-auto">
                <h1 class="text-3xl md:text-4xl font-bold mb-2">ðŸ‡ªðŸ‡¸ Exam Performance Report</h1>
                <p class="text-lg md:text-xl opacity-90">Student: Mohammed Zayan Syed | Course: Spanish IE4</p>
            </div>
        </header>

        <main class="max-w-5xl mx-auto p-4 md:p-8 space-y-12">

            <!-- Section 1: Executive Summary -->
            <section class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <!-- Big Score Card -->
                <div class="bg-white rounded-2xl p-8 card-shadow flex flex-col items-center justify-center text-center col-span-1 md:col-span-1 border-t-4 border-orange-500">
                    <h2 class="text-slate-500 font-semibold uppercase tracking-wider text-sm mb-2">Final Score</h2>
                    <div class="text-5xl md:text-6xl font-bold text-blue-600 mb-2">85.75%</div>
                    <p class="text-green-500 font-medium">PASS - Distinction Level</p>
                    <div class="mt-4 text-slate-400 text-sm">Time Taken: 38 Minutes</div>
                </div>

                <!-- Introduction Text -->
                <div class="bg-white rounded-2xl p-8 card-shadow col-span-1 md:col-span-2 flex flex-col justify-center">
                    <h2 class="text-2xl font-bold text-slate-800 mb-4">Performance Overview</h2>
                    <p class="text-slate-600 leading-relaxed text-lg">
                        Excellent work, Mohammed! You demonstrated a strong command of vocabulary related to <strong>Town</strong>, <strong>School</strong>, and <strong>House</strong>. Your writing composition was particularly detailed and creative. However, the data indicates specific challenges with <span class="text-orange-500 font-bold">irregular verbs</span> (Ser, Ir, Tener) and <span class="text-orange-500 font-bold">adjective agreement</span>. This report breaks down your results to help you target those specific areas for 100% mastery next time.
                    </p>
                </div>
            </section>

            <!-- Section 2: Macro Analysis (Chart.js) -->
            <section>
                <div class="mb-6">
                    <h3 class="text-2xl font-bold text-slate-800 border-l-4 border-blue-600 pl-4">Topic Proficiency Breakdown</h3>
                    <p class="mt-2 text-slate-600 max-w-3xl">
                        By categorizing the 71 questions into core competency areas, we can see a clear "skill profile." While your reading comprehension and vocabulary recall are elite, grammar mechanics (specifically verb conjugation) lagged slightly behind.
                    </p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <!-- Chart 1: Radar Chart for Skills -->
                    <div class="bg-white rounded-2xl p-6 card-shadow">
                        <h4 class="text-lg font-semibold text-center mb-4 text-slate-700">Competency Radar</h4>
                        <div class="chart-container">
                            <canvas id="skillRadarChart"></canvas>
                        </div>
                        <p class="text-center text-sm text-slate-400 mt-2">Proficiency % by Category</p>
                    </div>

                    <!-- Chart 2: Question Type Performance -->
                    <div class="bg-white rounded-2xl p-6 card-shadow">
                        <h4 class="text-lg font-semibold text-center mb-4 text-slate-700">Score Distribution by Question Type</h4>
                        <div class="chart-container">
                            <canvas id="scoreDistributionChart"></canvas>
                        </div>
                        <p class="text-center text-sm text-slate-400 mt-2">Points Earned vs. Points Missed</p>
                    </div>
                </div>
            </section>

            <!-- Section 3: Deep Dive - The Error Log (Chart.js Bar) -->
            <section>
                <div class="mb-6">
                    <h3 class="text-2xl font-bold text-slate-800 border-l-4 border-orange-500 pl-4">Critical Analysis: The "Missed" Concepts</h3>
                    <p class="mt-2 text-slate-600 max-w-3xl">
                        We identified 5 specific incorrect answers in the Multiple Choice section. These weren't random errors; they follow a pattern. The chart below identifies the specific concepts that caused difficulty.
                    </p>
                </div>

                <div class="bg-white rounded-2xl p-6 card-shadow">
                    <div class="chart-container w-full">
                        <canvas id="errorAnalysisChart"></canvas>
                    </div>
                    <div class="mt-6 grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="bg-orange-50 p-4 rounded-lg border border-orange-200">
                            <strong class="text-orange-600 block mb-1">Irregular Verbs</strong>
                            <p class="text-sm text-slate-600">Confused 'Ir' (to go) and the 'yo' form of 'Tener' (to have). Drill conjugation tables.</p>
                        </div>
                        <div class="bg-orange-50 p-4 rounded-lg border border-orange-200">
                            <strong class="text-orange-600 block mb-1">Adjectives</strong>
                            <p class="text-sm text-slate-600">"Feo" means Ugly, not funny. Vocabulary flashcards are recommended.</p>
                        </div>
                        <div class="bg-orange-50 p-4 rounded-lg border border-orange-200">
                            <strong class="text-orange-600 block mb-1">Seasons</strong>
                            <p class="text-sm text-slate-600">Mixed up "El Verano" (Summer). Remember: 'Verano' is warm, 'Invierno' is cold.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 4: Advanced Statistical Distribution (Plotly.js) -->
            <section>
                <div class="mb-6">
                    <h3 class="text-2xl font-bold text-slate-800 border-l-4 border-teal-500 pl-4">Cognitive Load & Difficulty Heatmap</h3>
                    <p class="mt-2 text-slate-600">
                        This heatmap visualizes the complexity of the exam sections. The <strong>Grammar</strong> section proved the most challenging (lowest accuracy), while <strong>Writing</strong> and <strong>Self-Description</strong> areas were high-performance zones.
                    </p>
                </div>
                
                <div class="bg-white rounded-2xl p-6 card-shadow overflow-hidden">
                    <div id="topicHeatmap" class="w-full h-96"></div>
                </div>
            </section>

            <!-- Section 5: Future Roadmap (HTML/CSS Flow) -->
            <section class="pb-12">
                <h3 class="text-2xl font-bold text-slate-800 border-l-4 border-blue-600 pl-4 mb-8">Path to 100%: Revision Strategy</h3>
                
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 relative">
                    
                    <!-- Connector Line (Desktop only) -->
                    <div class="hidden md:block absolute top-1/2 left-0 w-full h-1 bg-slate-200 -z-10 transform -translate-y-1/2"></div>

                    <!-- Step 1 -->
                    <div class="bg-white p-6 rounded-xl border-2 border-blue-100 shadow-sm relative z-10 hover:border-blue-500 transition-colors">
                        <div class="w-10 h-10 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold text-lg mb-4 mx-auto">1</div>
                        <h4 class="font-bold text-center text-slate-800">Verb Drill</h4>
                        <p class="text-sm text-center text-slate-500 mt-2">Focus on "Ir", "Ser", and "Tener". Create a table for 'Yo' forms.</p>
                    </div>

                    <!-- Step 2 -->
                    <div class="bg-white p-6 rounded-xl border-2 border-orange-100 shadow-sm relative z-10 hover:border-orange-500 transition-colors">
                        <div class="w-10 h-10 bg-orange-500 text-white rounded-full flex items-center justify-center font-bold text-lg mb-4 mx-auto">2</div>
                        <h4 class="font-bold text-center text-slate-800">Adjectives</h4>
                        <p class="text-sm text-center text-slate-500 mt-2">Review opposites: Bonito/Feo, Grande/PequeÃ±o.</p>
                    </div>

                    <!-- Step 3 -->
                    <div class="bg-white p-6 rounded-xl border-2 border-teal-100 shadow-sm relative z-10 hover:border-teal-500 transition-colors">
                        <div class="w-10 h-10 bg-teal-500 text-white rounded-full flex items-center justify-center font-bold text-lg mb-4 mx-auto">3</div>
                        <h4 class="font-bold text-center text-slate-800">Grammar Check</h4>
                        <p class="text-sm text-center text-slate-500 mt-2">Practice agreement: "Me gusta el..." vs "Me gustan los..."</p>
                    </div>

                    <!-- Step 4 -->
                    <div class="bg-white p-6 rounded-xl border-2 border-slate-100 shadow-sm relative z-10 hover:border-slate-500 transition-colors">
                        <div class="w-10 h-10 bg-slate-800 text-white rounded-full flex items-center justify-center font-bold text-lg mb-4 mx-auto">4</div>
                        <h4 class="font-bold text-center text-slate-800">Re-Test</h4>
                        <p class="text-sm text-center text-slate-500 mt-2">Attempt the blank exam again with a 30-minute timer.</p>
                    </div>
                </div>
            </section>

        </main>

        <footer class="bg-slate-800 text-slate-400 py-8 text-center">
            <p>Â© 2024 Canvas Infographics | Data Visualization for Education</p>
        </footer>
    </div>

    <!-- JAVASCRIPT LOGIC -->
    <script>
        // --- UTILITY: Label Wrapping Function (16 char limit) ---
        function splitLabel(str, maxLen = 16) {
            if (str.length <= maxLen) return str;
            const words = str.split(' ');
            const lines = [];
            let currentLine = words[0];

            for (let i = 1; i < words.length; i++) {
                if ((currentLine.length + 1 + words[i].length) <= maxLen) {
                    currentLine += ' ' + words[i];
                } else {
                    lines.push(currentLine);
                    currentLine = words[i];
                }
            }
            lines.push(currentLine);
            return lines;
        }

        // --- COMMON: Tooltip Configuration ---
        const commonTooltipOptions = {
            callbacks: {
                title: function(tooltipItems) {
                    const item = tooltipItems[0];
                    let label = item.chart.data.labels[item.dataIndex];
                    if (Array.isArray(label)) {
                        return label.join(' ');
                    } else {
                        return label;
                    }
                }
            }
        };

        // --- CHART 1: SKILL RADAR (Chart.js) ---
        const ctxRadar = document.getElementById('skillRadarChart').getContext('2d');
        new Chart(ctxRadar, {
            type: 'radar',
            data: {
                labels: [
                    splitLabel('Town & Directions Vocab'), 
                    splitLabel('Family & House Vocab'), 
                    splitLabel('Verb Conjugation'), 
                    splitLabel('Reading Comprehension'), 
                    splitLabel('Creative Writing'),
                    splitLabel('Adjective Agreement')
                ],
                datasets: [{
                    label: 'Proficiency Score (%)',
                    data: [95, 90, 65, 100, 92, 70],
                    backgroundColor: 'rgba(37, 99, 235, 0.2)',
                    borderColor: '#2563EB',
                    pointBackgroundColor: '#F97316',
                    pointBorderColor: '#fff',
                    pointHoverBackgroundColor: '#fff',
                    pointHoverBorderColor: '#F97316'
                }]
            },
            options: {
                maintainAspectRatio: false,
                scales: {
                    r: {
                        angleLines: { color: '#E2E8F0' },
                        grid: { color: '#E2E8F0' },
                        pointLabels: {
                            font: { size: 12, family: "'Poppins', sans-serif" },
                            color: '#475569'
                        },
                        suggestedMin: 50,
                        suggestedMax: 100
                    }
                },
                plugins: {
                    tooltip: commonTooltipOptions,
                    legend: { display: false }
                }
            }
        });

        // --- CHART 2: SCORE DISTRIBUTION (Chart.js) ---
        const ctxDoughnut = document.getElementById('scoreDistributionChart').getContext('2d');
        new Chart(ctxDoughnut, {
            type: 'doughnut',
            data: {
                labels: ['Correct Answers', 'Incorrect Answers'],
                datasets: [{
                    data: [85.75, 14.25],
                    backgroundColor: [
                        '#14B8A6', // Teal (Correct)
                        '#F97316'  // Orange (Incorrect)
                    ],
                    borderWidth: 0
                }]
            },
            options: {
                maintainAspectRatio: false,
                cutout: '70%',
                plugins: {
                    tooltip: commonTooltipOptions,
                    legend: {
                        position: 'bottom',
                        labels: { font: { family: "'Poppins', sans-serif" } }
                    }
                }
            }
        });

        // --- CHART 3: ERROR ANALYSIS (Chart.js Bar) ---
        const ctxBar = document.getElementById('errorAnalysisChart').getContext('2d');
        new Chart(ctxBar, {
            type: 'bar',
            data: {
                labels: [
                    splitLabel('Verb "Ir" (To Go)'),
                    splitLabel('Verb "Ser" (To Be)'),
                    splitLabel('Verb "Tener" (To Have)'),
                    splitLabel('Adjective "Feo" (Ugly)'),
                    splitLabel('Season "Verano" (Summer)')
                ],
                datasets: [{
                    label: 'Points Lost (Weighted Impact)',
                    data: [1, 1, 1, 1, 1],
                    backgroundColor: '#F97316',
                    borderRadius: 6
                }]
            },
            options: {
                maintainAspectRatio: false,
                indexAxis: 'y',
                scales: {
                    x: {
                        beginAtZero: true,
                        display: false
                    },
                    y: {
                        grid: { display: false },
                        ticks: {
                            font: { family: "'Poppins', sans-serif" },
                            color: '#475569'
                        }
                    }
                },
                plugins: {
                    tooltip: commonTooltipOptions,
                    legend: { display: false }
                }
            }
        });

        // --- CHART 4: HEATMAP (Plotly.js) ---
        const zValues = [
            [95, 90, 80],
            [60, 70, 65],
            [100, 95, 90]
        ];
        
        const xValues = ['Multiple Choice', 'Fill in Blank', 'Composition'];
        const yValues = ['Vocabulary', 'Grammar', 'Writing'];

        const dataPlotly = [{
            z: zValues,
            x: xValues,
            y: yValues,
            type: 'heatmap',
            colorscale: [
                [0, '#F97316'],
                [0.5, '#FDBA74'],
                [0.7, '#14B8A6'],
                [1, '#2563EB']
            ],
            showscale: true
        }];

        const layoutPlotly = {
            margin: { t: 30, l: 100, r: 30, b: 30 },
            font: { family: 'Poppins, sans-serif' },
            paper_bgcolor: 'rgba(0,0,0,0)',
            plot_bgcolor: 'rgba(0,0,0,0)',
            autosize: true
        };

        const configPlotly = {
            responsive: true,
            displayModeBar: false
        };

        Plotly.newPlot('topicHeatmap', dataPlotly, layoutPlotly, configPlotly);

    </script>
</body>
</html>
